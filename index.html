<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mint NFTs on Base ‚Ä¢ Legendary Edition</title>
  <link rel="preconnect" href="https://auth.farcaster.xyz" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: { 
        extend: { 
          colors: { 
            primary: '#0066FF',
            legendary: '#6366F1',
            aurora: '#8B5CF6'
          },
          animation: {
            'aurora': 'aurora 20s ease-in-out infinite',
            'glow-pulse': 'glow-pulse 2s ease-in-out infinite alternate',
            'float': 'float 6s ease-in-out infinite',
            'shimmer': 'shimmer 2.5s linear infinite',
            'scale-glow': 'scale-glow 0.3s ease-out',
            'loading': 'loading 1.5s infinite'
          },
          keyframes: {
            aurora: {
              '0%, 100%': { 
                transform: 'translateX(-50%) translateY(-50%) rotate(0deg) scale(1)',
                opacity: '0.3'
              },
              '33%': { 
                transform: 'translateX(-30%) translateY(-60%) rotate(120deg) scale(1.1)',
                opacity: '0.5'
              },
              '66%': { 
                transform: 'translateX(-70%) translateY(-40%) rotate(240deg) scale(0.9)',
                opacity: '0.4'
              }
            },
            'glow-pulse': {
              '0%': { boxShadow: '0 0 20px rgba(99, 102, 241, 0.3)' },
              '100%': { boxShadow: '0 0 40px rgba(99, 102, 241, 0.6), 0 0 80px rgba(99, 102, 241, 0.2)' }
            },
            'float': {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' }
            },
            'shimmer': {
              '0%': { transform: 'translateX(-100%)' },
              '100%': { transform: 'translateX(100%)' }
            },
            'scale-glow': {
              '0%': { transform: 'scale(1)', boxShadow: '0 0 0 rgba(99, 102, 241, 0)' },
              '100%': { transform: 'scale(1.05)', boxShadow: '0 0 30px rgba(99, 102, 241, 0.4)' }
            },
            'loading': { 
              '0%': { backgroundPosition: '200% 0' }, 
              '100%': { backgroundPosition: '-200% 0' } 
            }
          }
        } 
      }
    };
  </script>
  
  <!-- Farcaster Mini App Metadata -->
  <meta name="fc:miniapp" content='{
    "version":"1",
    "imageUrl":"https://nft-mini-app-opal.vercel.app/image.png",
    "button":{
      "title":"NFT Minter ‚Ä¢ Legendary",
      "action":{
        "type":"launch_miniapp",
        "name":"NFT Minter ‚Ä¢ Legendary",
        "url":"https://nft-mini-app-opal.vercel.app/",
        "splashImageUrl":"https://nft-mini-app-opal.vercel.app/splash.png",
        "splashBackgroundColor":"#0f0f23"
      }
    }
  }' />
  
  <!-- Open Graph -->
  <meta property="og:title" content="NFT Minter ‚Ä¢ Legendary Edition ‚Ä¢ Farcaster MiniApp" />
  <meta property="og:description" content="Premium NFT minting experience on Base blockchain with legendary UI" />
  <meta property="og:image" content="https://nft-mini-app-opal.vercel.app/image.png" />
  <meta property="og:url" content="https://nft-mini-app-opal.vercel.app/" />
  <meta name="twitter:card" content="summary_large_image" />
  
  <!-- Farcaster Frame -->
  <meta name="fc:frame" content="vNext" />
  <meta name="fc:frame:image" content="https://nft-mini-app-opal.vercel.app/image.png" />
  <meta name="fc:frame:button:1" content="Launch Legendary Minter" />
  <meta name="fc:frame:button:1:action" content="link" />
  <meta name="fc:frame:button:1:target" content="https://nft-mini-app-opal.vercel.app/" />

  <style>
    /* Custom CSS for legendary effects */
    .aurora-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -2;
      background: linear-gradient(45deg, #0f0f23, #1a1b3e, #2d1b69, #0f0f23);
      background-size: 400% 400%;
      animation: aurora 15s ease-in-out infinite;
    }
    
    .aurora-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(99, 102, 241, 0.4) 0%, rgba(139, 92, 246, 0.2) 40%, transparent 70%);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      animation: aurora 20s ease-in-out infinite;
      filter: blur(40px);
    }
    
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background-image: 
        radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(139, 92, 246, 0.4), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(99, 102, 241, 0.5), transparent),
        radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.2), transparent),
        radial-gradient(2px 2px at 160px 30px, rgba(139, 92, 246, 0.3), transparent);
      background-repeat: repeat;
      background-size: 200px 100px;
      animation: float 8s ease-in-out infinite;
    }
    
    .glass-card {
      background: rgba(15, 15, 35, 0.4);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(99, 102, 241, 0.2);
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 20px rgba(99, 102, 241, 0.1);
    }
    
    .glass-header {
      background: rgba(15, 15, 35, 0.6);
      backdrop-filter: blur(30px);
      border-bottom: 1px solid rgba(99, 102, 241, 0.2);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    .legendary-button {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.8), rgba(139, 92, 246, 0.8));
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .legendary-button:hover {
      animation: scale-glow 0.3s ease-out forwards;
      background: linear-gradient(135deg, rgba(99, 102, 241, 1), rgba(139, 92, 246, 1));
    }
    
    .legendary-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s ease;
    }
    
    .legendary-button:hover::before {
      left: 100%;
    }
    
    .status-glow {
      width: 8px;
      height: 8px;
      background: #10B981;
      border-radius: 50%;
      box-shadow: 0 0 10px #10B981, 0 0 20px rgba(16, 185, 129, 0.5);
      animation: glow-pulse 1.5s ease-in-out infinite alternate;
    }
    
    .card-hover {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .card-hover:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.4),
        0 0 30px rgba(99, 102, 241, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    .modal-backdrop {
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(20px);
    }
    
    .legendary-modal {
      background: rgba(15, 15, 35, 0.95);
      backdrop-filter: blur(40px);
      border: 1px solid rgba(99, 102, 241, 0.3);
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.5),
        0 0 50px rgba(99, 102, 241, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .shimmer { 
      background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%); 
      background-size: 200% 100%; 
      animation: loading 1.5s infinite; 
    }
    
    .collection-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
    }
    
    @media (max-width: 640px) {
      .legendary-modal { 
        margin: 1rem;
        max-width: calc(100% - 2rem);
        max-height: calc(100vh - 2rem);
      }
    }
  </style>
</head>

<body class="min-h-screen text-white relative overflow-x-hidden">
  <!-- Aurora Background -->
  <div class="aurora-bg"></div>
  <div class="aurora-glow"></div>
  <div class="stars"></div>
  
  <!-- Loading Screen -->
  <div id="loading" class="fixed inset-0 modal-backdrop z-50 flex items-center justify-center">
    <div class="legendary-modal rounded-3xl p-8 max-w-md mx-4 text-center">
      <div class="mb-6">
        <div class="w-16 h-16 mx-auto bg-gradient-to-br from-legendary to-aurora rounded-2xl flex items-center justify-center mb-4">
          <span class="text-2xl">üíé</span>
        </div>
        <h2 class="text-2xl font-bold mb-2 bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
          Legendary NFT Minter
        </h2>
      </div>
      
      <div class="space-y-4">
        <div class="flex items-center justify-center space-x-2">
          <div id="status-dot" class="w-3 h-3 bg-legendary rounded-full animate-pulse"></div>
          <div id="status-dot-final" class="status-glow hidden"></div>
          <span id="status-text" class="text-blue-200">Initializing...</span>
        </div>
        
        <div class="w-full bg-gray-700 rounded-full h-2">
          <div class="bg-gradient-to-r from-legendary to-aurora h-2 rounded-full shimmer"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Header -->
  <header class="glass-header fixed top-0 left-0 right-0 z-40 p-4">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="relative">
          <div class="w-10 h-10 bg-gradient-to-br from-legendary to-aurora rounded-xl flex items-center justify-center shadow-lg">
            <span class="text-lg font-bold">üíé</span>
          </div>
          <div class="absolute -top-1 -right-1">
            <div id="header-status" class="status-glow"></div>
          </div>
        </div>
        <div>
          <h1 class="text-xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
            Legendary NFT Minter
          </h1>
          <p class="text-xs text-blue-300 opacity-80">Base ‚Ä¢ Farcaster</p>
        </div>
      </div>
      
      <div class="flex items-center space-x-3">
        <div class="hidden sm:flex items-center space-x-2 text-xs">
          <div class="status-glow"></div>
          <span id="connection-status" class="text-green-300">Connected</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="pt-24 pb-8 px-4 relative z-10">
    <div class="max-w-6xl mx-auto">
      
      <!-- Hero Section -->
      <div class="text-center mb-12 animate-float">
        <h2 class="text-4xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-white via-blue-200 to-purple-300 bg-clip-text text-transparent">
          Mint Legendary NFTs
        </h2>
        <p class="text-lg text-blue-200 opacity-90 max-w-2xl mx-auto leading-relaxed">
          Experience the future of NFT minting with our premium glassmorphic interface on Base blockchain
        </p>
      </div>

      <!-- Collections Grid -->
      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
          üé® Featured Collections
        </h3>
        <div id="collections-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Collections will be populated by JavaScript -->
        </div>
      </div>

      <!-- Stats Section -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
        <div class="glass-card card-hover rounded-2xl p-6 text-center">
          <div class="text-3xl mb-2">‚ö°</div>
          <div class="text-2xl font-bold text-white mb-1">Fast</div>
          <div class="text-sm text-blue-300 opacity-80">Lightning Mints</div>
        </div>
        
        <div class="glass-card card-hover rounded-2xl p-6 text-center">
          <div class="text-3xl mb-2">üõ°Ô∏è</div>
          <div class="text-2xl font-bold text-white mb-1">Secure</div>
          <div class="text-sm text-blue-300 opacity-80">Base Network</div>
        </div>
        
        <div class="glass-card card-hover rounded-2xl p-6 text-center">
          <div class="text-3xl mb-2">üíé</div>
          <div class="text-2xl font-bold text-white mb-1">Premium</div>
          <div class="text-sm text-blue-300 opacity-80">Legendary Quality</div>
        </div>
      </div>
    </div>
  </main>

  <!-- NFT Modal -->
  <div id="mint-modal" class="fixed inset-0 modal-backdrop z-50 flex items-center justify-center hidden">
    <div class="legendary-modal rounded-3xl p-8 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h3 id="modal-title" class="text-2xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
          Collection Details
        </h3>
        <button onclick="closeMintModal()" class="text-blue-300 hover:text-white text-2xl transition-colors">
          ‚úï
        </button>
      </div>
      
      <div id="modal-content">
        <!-- Modal content will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div id="toast" class="fixed top-20 right-4 glass-card rounded-xl p-4 text-white transform translate-x-full transition-transform duration-300 z-50 border border-legendary/30">
    <div class="flex items-center space-x-3">
      <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
      <span id="toast-message"></span>
    </div>
  </div>

  <script type="module">
    import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk@latest';
    import { createConfig, connect, http, watchAccount } from 'https://esm.sh/@wagmi/core@2';
    import { base } from 'https://esm.sh/@wagmi/core@2/chains';
    import { farcasterMiniApp } from 'https://esm.sh/@farcaster/miniapp-wagmi-connector@latest';

    // Global State
    let isConnected = false;
    let currentEnv = '';
    let userFid = null;
    let userAddress = null;
    let buenoLoaded = false;
    let NFT_COLLECTIONS = [];

    // Load Bueno Widget (kept for potential future use)
    async function loadBueno() {
      if (buenoLoaded) return;
      try {
        const css = document.createElement('link');
        css.rel = 'stylesheet';
        css.href = 'https://app.bueno.art/widget/v3/styles.css';
        document.head.appendChild(css);

        const script = document.createElement('script');
        script.type = 'module';
        script.src = 'https://app.bueno.art/widget/v3/index.js';
        script.onload = () => { buenoLoaded = true; };
        document.head.appendChild(script);
      } catch (e) {
        console.error('Bueno load error:', e);
        showToast('Failed to load widget');
      }
    }

    // Load Collections
    async function loadCollections() {
      try {
        const res = await fetch('/collections.json');
        if (res.ok) {
          NFT_COLLECTIONS = await res.json();
        } else {
          throw new Error('No collections.json');
        }
      } catch {
        // Fallback collections with legendary styling
        NFT_COLLECTIONS = [
          {
            id: 'collection1',
            name: 'Cosmic Cats',
            thumbnail: 'https://via.placeholder.com/200x200/6366F1/FFFFFF?text=üê±‚ú®',
            mintId: '2rxrfAyczryfJ-o7mxP1Q',
            description: 'Adorable cats exploring the cosmos‚Äîmint on Base blockchain!',
            rarity: 'Legendary'
          },
          {
            id: 'collection2', 
            name: 'Crystal Dragons',
            thumbnail: 'https://via.placeholder.com/200x200/8B5CF6/FFFFFF?text=üêâüíé',
            mintId: 'dragon-crystal-base',
            description: 'Majestic crystal dragons with mystical powers and rare traits.',
            rarity: 'Mythic'
          },
          {
            id: 'collection3',
            name: 'Cyber Samurai',
            thumbnail: 'https://via.placeholder.com/200x200/0066FF/FFFFFF?text=‚öîÔ∏èü§ñ',
            mintId: 'cyber-samurai-nft',
            description: 'Futuristic warriors from the digital realm, ready for battle.',
            rarity: 'Epic'
          }
        ];
      }
    }

    // Initialize App
    async function initApp() {
      const statusText = document.getElementById('status-text');
      const spinner = document.getElementById('status-dot');
      const finalDot = document.getElementById('status-dot-final');
      const loading = document.getElementById('loading');
      
      spinner.classList.remove('hidden');
      statusText.textContent = 'üöÄ Loading Legendary Experience...';

      try {
        // Check if in MiniApp
        const isMiniApp = await sdk.isInMiniApp();
        
        if (!isMiniApp) {
          throw new Error('Not in MiniApp');
        }

        // Initialize SDK
        await sdk.actions.ready({});
        statusText.textContent = 'üîó Connecting to Farcaster...';

        // Setup Wagmi config
        const config = createConfig({
          chains: [base],
          transports: { [base.id]: http() }
        });

        // Connect wallet
        statusText.textContent = 'üí∞ Connecting Wallet...';
        const account = await connect(config, { connector: farcasterMiniApp() });
        isConnected = !!account.addresses?.[0];
        userAddress = account.addresses?.[0];

        // Watch account changes
        watchAccount(config, {
          onChange(data) {
            isConnected = !!data.addresses?.[0];
            userAddress = data.addresses?.[0];
            updateStatus(isConnected, currentEnv);
          }
        });

        // Get context
        statusText.textContent = 'üåü Loading Collections...';
        const ctx = await sdk.context;
        if (ctx?.user?.fid) {
          userFid = ctx.user.fid;
        }
        currentEnv = ctx?.client?.name || 'miniapp';

        // Load collections and Bueno
        await Promise.all([
          loadCollections(),
          loadBueno()
        ]);

        // Success state
        spinner.classList.add('hidden');
        finalDot.classList.remove('hidden');
        statusText.textContent = '‚ú® Ready to Mint!';
        
        setTimeout(() => {
          loading.classList.add('hidden');
          updateStatus(isConnected, currentEnv);
          renderCollections();
          showToast('üéâ Welcome to the Legendary NFT Experience!');
        }, 1500);

      } catch (error) {
        console.error('Init error:', error);
        statusText.textContent = '‚ùå Connection failed - please refresh';
        showToast('Failed to initialize. Please refresh and try again.');
      }
    }

    // Update Status
    function updateStatus(connected, env) {
      const connectionStatus = document.getElementById('connection-status');
      if (connected) {
        connectionStatus.textContent = `Connected ‚Ä¢ ${userAddress?.slice(0, 6)}...${userAddress?.slice(-4)}`;
        connectionStatus.className = 'text-green-300';
      } else {
        connectionStatus.textContent = 'Disconnected';
        connectionStatus.className = 'text-red-300';
      }
    }

    // Render Collections
    function renderCollections() {
      const grid = document.getElementById('collections-grid');
      grid.innerHTML = NFT_COLLECTIONS.map(col => `
        <div class="glass-card card-hover collection-card rounded-2xl overflow-hidden cursor-pointer transition-all"
             onclick="openMintModal('${col.id}')">
          <div class="aspect-square bg-gradient-to-br from-legendary/20 to-aurora/20 flex items-center justify-center text-6xl">
            ${col.thumbnail.includes('placeholder') ? col.thumbnail.split('text=')[1]?.split('&')[0] || 'üé®' : `<img src="${col.thumbnail}" alt="${col.name}" class="w-full h-full object-cover" />`}
          </div>
          <div class="p-6">
            <div class="flex items-center justify-between mb-2">
              <h4 class="text-xl font-bold text-white">${col.name}</h4>
              <span class="text-xs px-2 py-1 rounded-full bg-legendary/20 text-legendary border border-legendary/30">
                ${col.rarity || 'Rare'}
              </span>
            </div>
            <p class="text-sm text-blue-200 opacity-90 leading-relaxed">${col.description}</p>
            <div class="mt-4 pt-4 border-t border-legendary/20">
              <button class="legendary-button w-full py-2 px-4 rounded-lg text-sm font-semibold">
                <span class="relative z-10">üöÄ Mint Now</span>
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Show Toast
    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      
      toastMessage.textContent = message;
      toast.classList.remove('translate-x-full');
      toast.classList.add('animate-glow-pulse');
      
      setTimeout(() => {
        toast.classList.add('translate-x-full');
        toast.classList.remove('animate-glow-pulse');
      }, 4000);
    }

    // Open Mint Modal
    window.openMintModal = function(id) {
      const col = NFT_COLLECTIONS.find(c => c.id === id);
      if (!col) return;

      const modal = document.getElementById('mint-modal');
      const title = document.getElementById('modal-title');
      const content = document.getElementById('modal-content');

      title.textContent = col.name;
      content.innerHTML = `
        <div class="space-y-6">
          <div class="aspect-square bg-gradient-to-br from-legendary/20 to-aurora/20 rounded-2xl flex items-center justify-center text-8xl mb-6">
            ${col.thumbnail.includes('placeholder') ? col.thumbnail.split('text=')[1]?.split('&')[0] || 'üé®' : `<img src="${col.thumbnail}" alt="${col.name}" class="w-full h-full object-cover rounded-2xl" />`}
          </div>
          
          <div class="text-center">
            <h4 class="text-2xl font-bold mb-2 bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
              ${col.name}
            </h4>
            <p class="text-blue-200 opacity-90 mb-4">${col.description}</p>
            
            <div class="flex items-center justify-center space-x-4 mb-6">
              <div class="glass-card rounded-xl p-3">
                <div class="text-sm text-blue-300">Rarity</div>
                <div class="font-bold text-legendary">${col.rarity || 'Rare'}</div>
              </div>
              <div class="glass-card rounded-xl p-3">
                <div class="text-sm text-blue-300">Chain</div>
                <div class="font-bold text-primary">Base</div>
              </div>
              <div class="glass-card rounded-xl p-3">
                <div class="text-sm text-blue-300">Price</div>
                <div class="font-bold text-green-400">Free</div>
              </div>
            </div>
            
            <button 
              onclick="launchBuenoWidget('${col.mintId}')" 
              class="legendary-button w-full py-4 px-6 rounded-xl text-lg font-bold mb-3"
            >
              <span class="relative z-10">üöÄ Mint ${col.name}</span>
            </button>
            
            <button 
              onclick="closeMintModal()" 
              class="w-full py-3 px-6 rounded-xl border border-legendary/30 text-blue-300 hover:bg-legendary/10 transition-all"
            >
              Cancel
            </button>
          </div>
        </div>
      `;

      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    // Close Mint Modal
    window.closeMintModal = function() {
      const modal = document.getElementById('mint-modal');
      modal.classList.add('hidden');
      document.body.style.overflow = 'auto';
    }

    // Launch Bueno Widget
    window.launchBuenoWidget = function(mintId) {
      if (!buenoLoaded) {
        showToast('Widget still loading, please wait...');
        return;
      }

      try {
        if (window.BuenoWidget) {
          window.BuenoWidget.launch({
            mintId: mintId,
            theme: 'dark',
            onSuccess: (data) => {
              showToast(`üéâ Successfully minted! TX: ${data.transactionHash?.slice(0, 10)}...`);
              closeMintModal();
            },
            onError: (error) => {
              showToast('Minting failed. Please try again.');
              console.error('Mint error:', error);
            }
          });
        } else {
          showToast('Widget not available. Please refresh and try again.');
        }
      } catch (error) {
        console.error('Launch error:', error);
        showToast('Failed to launch minting widget.');
      }
    }

    // Global error handler
    window.addEventListener('error', (e) => {
      if (e.error?.message?.includes('context') || e.error?.message?.includes('SDK')) {
        showToast('‚ö†Ô∏è SDK Error - please refresh the page');
      }
    });

    // Add interactive sparkles on click
    document.addEventListener('click', (e) => {
      if (e.target.closest('.legendary-button')) {
        const sparkle = document.createElement('div');
        sparkle.innerHTML = '‚ú®';
        sparkle.style.position = 'absolute';
        sparkle.style.left = e.clientX + 'px';
        sparkle.style.top = e.clientY + 'px';
        sparkle.style.pointerEvents = 'none';
        sparkle.style.animation = 'float 1s ease-out forwards';
        sparkle.style.zIndex = '1000';
        sparkle.style.fontSize = '20px';
        document.body.appendChild(sparkle);
        
        setTimeout(() => sparkle.remove(), 1000);
      }
    });

    // Start the legendary experience
    window.addEventListener('load', initApp);
  </script>
</body>
</html>
